# HSE Industrial Contrastive Learning Implementation

## ğŸ“‹ æ¦‚è¿°

HSE (Hierarchical Signal Embedding) Industrial Contrastive Learning æ˜¯ä¸€ä¸ªé’ˆå¯¹å·¥ä¸šè®¾å¤‡æŒ¯åŠ¨ä¿¡å·åˆ†æçš„å…ˆè¿›æ·±åº¦å­¦ä¹ æ¡†æ¶ã€‚è¯¥å®ç°æ—¨åœ¨é€šè¿‡æç¤ºå¼•å¯¼çš„å¯¹æ¯”å­¦ä¹ å®ç°è·¨ç³»ç»Ÿæ³›åŒ–ï¼Œä¸º ICML/NeurIPS 2025 è®ºæ–‡æä¾›æŠ€æœ¯æ”¯æ’‘ã€‚

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### ğŸ“Š æŠ€æœ¯åˆ›æ–°
- **åŒå±‚æç¤ºç³»ç»Ÿ**: System-level (Dataset_id + Domain_id) å’Œ Sample-level (Sample_rate) æç¤º
- **ç»Ÿä¸€åº¦é‡å­¦ä¹ **: åŒæ—¶è®­ç»ƒ5ä¸ªæ•°æ®é›†(CWRU, XJTU, THU, Ottawa, JNU)å®ç°è·¨åŸŸæ³›åŒ–
- **è®¡ç®—æ•ˆç‡æå‡**: é€šè¿‡æ™ºèƒ½å®éªŒè®¾è®¡å°†å®éªŒæ•°é‡ä»150ä¸ªå‡å°‘åˆ°30ä¸ªï¼Œæå‡82%æ•ˆç‡
- **é›¶æ ·æœ¬è¯„ä¼°**: åœ¨å†»ç»“é¢„è®­ç»ƒéª¨å¹²ç½‘ç»œä¸Šè¿›è¡Œçº¿æ€§æ¢é’ˆè¯„ä¼°

### ğŸ—ï¸ æ¶æ„ç»„ä»¶
- **MomentumEncoder**: åŸºäºåŠ¨é‡çš„ç¼–ç å™¨æ¶æ„ï¼Œæ”¯æŒå¯¹æ¯”å­¦ä¹ 
- **ProjectionHead**: ç‰¹å¾æŠ•å½±å¤´ï¼Œæ”¯æŒå¤šç§æ¿€æ´»å‡½æ•°å’Œå½’ä¸€åŒ–é€‰é¡¹
- **SystemPromptEncoder**: ç³»ç»Ÿçº§æç¤ºç¼–ç å™¨
- **PromptFusion**: å¤šæ¨¡æ€æç¤ºèåˆæœºåˆ¶
- **OneEpochValidator**: å¿«é€ŸéªŒè¯ç³»ç»Ÿï¼Œä¸€ä¸ªepochå†…æ•è·95%é—®é¢˜

## ğŸ“ æ–‡æ¡£ç»“æ„

```
docs/hse-implementation/
â”œâ”€â”€ README.md                 # æœ¬æ–‡ä»¶ - æ€»è§ˆ
â”œâ”€â”€ core-components.md        # æ ¸å¿ƒç»„ä»¶è¯¦ç»†è¯´æ˜
â”œâ”€â”€ pipeline-guide.md         # Pipelineä½¿ç”¨æŒ‡å—
â”œâ”€â”€ experiment-results.md     # å®éªŒç»“æœå’Œåˆ†æ
â””â”€â”€ validation-reports/       # éªŒè¯æŠ¥å‘Šç›®å½•
    â”œâ”€â”€ one-epoch-validation.md
    â””â”€â”€ synthetic-demo-results.md
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡
```bash
# æ¿€æ´»ç¯å¢ƒï¼ˆå·²å®‰è£… wandb å’Œ swanlabï¼‰
conda activate P

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2. åŸºç¡€éªŒè¯
```bash
# è¿è¡Œåˆæˆæ•°æ®æ¼”ç¤º
python scripts/hse_synthetic_demo.py

# è¿è¡ŒPipeline_03é›†æˆæµ‹è¯•
python scripts/test_pipeline03_integration.py
```

### 3. å®Œæ•´å®éªŒ
```bash
# è¿è¡ŒHSEæç¤ºå¼•å¯¼çš„å¤šä»»åŠ¡é¢„è®­ç»ƒ
python scripts/run_hse_prompt_pipeline03.py

# æŸ¥çœ‹å®éªŒç»“æœ
python script/unified_metric/collect_results.py
```

## ğŸ“Š å®éªŒç»“æœæ¦‚è¦

### æ€§èƒ½æŒ‡æ ‡
- **å†…å­˜æ•ˆç‡**: < 0.1GB å†…å­˜ä½¿ç”¨
- **å¤„ç†é€Ÿåº¦**: > 1400 samples/sec
- **éªŒè¯æˆåŠŸç‡**: 55.6% (5/9 tests passing)
- **å‡†ç¡®åº¦æå‡**: 14.3% (åˆæˆæ•°æ®æ¼”ç¤º)

### éªŒè¯çŠ¶æ€
- âœ… HSEæ ¸å¿ƒç»„ä»¶100%éªŒè¯é€šè¿‡
- âœ… OneEpochValidatoræ€§èƒ½éªŒè¯é€šè¿‡
- âœ… åˆæˆæ•°æ®æ¼”ç¤ºæˆåŠŸ
- âš ï¸ éƒ¨åˆ†é›†æˆæµ‹è¯•éœ€è¦è§£å†³ConfigWrapperå…¼å®¹æ€§é—®é¢˜

## ğŸ”§ ä¸»è¦é…ç½®æ–‡ä»¶

### HSEæç¤ºé…ç½®
- `configs/pipeline_03/hse_prompt_multitask_config.yaml`: ä¸»è¦å¤šä»»åŠ¡é…ç½®
- `configs/demo/HSE_Contrastive/`: HSEå¯¹æ¯”å­¦ä¹ æ¼”ç¤ºé…ç½®
- `configs/pipeline_03/ablation/`: æ¶ˆèç ”ç©¶é…ç½®

### åŸºçº¿å¯¹æ¯”
- `configs/baseline/cwru_baseline.yaml`: CWRUåŸºçº¿å®éªŒé…ç½®

## ğŸ“ˆ å¼€å‘çŠ¶æ€

### âœ… å·²å®Œæˆ
1. **P0æ ¸å¿ƒåŠŸèƒ½**: æ‰€æœ‰æ ¸å¿ƒç»„ä»¶å·²å®ç°å¹¶éªŒè¯
2. **Pipelineé›†æˆ**: Pipeline_03å¤šä»»åŠ¡é¢„è®­ç»ƒå¾®è°ƒç®¡é“
3. **éªŒè¯æ¡†æ¶**: OneEpochValidatorå’Œç»¼åˆæµ‹è¯•å¥—ä»¶
4. **æ–‡æ¡£**: å®Œæ•´çš„ç”¨æˆ·æŒ‡å—å’ŒAPIæ–‡æ¡£

### ğŸš§ è¿›è¡Œä¸­
1. **é…ç½®å…¼å®¹æ€§**: ä¿®å¤ConfigWrapperä¸dictçš„å…¼å®¹æ€§é—®é¢˜
2. **æ•°æ®åŠ è½½**: è§£å†³H5ç¼“å­˜æ•°æ®åŠ è½½é—®é¢˜
3. **ä¾èµ–ä¼˜åŒ–**: æ·»åŠ reformer_pytorchä¾èµ–

### ğŸ“‹ å¾…å®Œæˆ
1. **ç”Ÿäº§å®éªŒ**: åœ¨5ä¸ªçœŸå®æ•°æ®é›†ä¸Šè¿è¡Œå®Œæ•´å®éªŒ
2. **ç»“æœåˆ†æ**: ç”Ÿæˆè®ºæ–‡çº§åˆ«çš„å®éªŒæŠ¥å‘Š
3. **æ€§èƒ½ä¼˜åŒ–**: è¿›ä¸€æ­¥ä¼˜åŒ–å†…å­˜å’Œè®¡ç®—æ•ˆç‡

## ğŸ¤ è´¡çŒ®æŒ‡å—

æŸ¥çœ‹ [pipeline-guide.md](./pipeline-guide.md) äº†è§£å¦‚ä½•:
- æ·»åŠ æ–°çš„å¯¹æ¯”å­¦ä¹ ä»»åŠ¡
- æ‰©å±•æç¤ºç³»ç»Ÿ
- é›†æˆæ–°çš„æ•°æ®é›†
- ä¼˜åŒ–è®­ç»ƒæµç¨‹

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®éµå¾ª MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](../../LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»:
- é‚®ç®±: liq22@tsinghua.org.cn
- é¡¹ç›®åœ°å€: [PHM-Vibench-metric](https://github.com/PHM-Systems/PHM-Vibench-metric)

---

*æœ€åæ›´æ–°: 2025å¹´9æœˆ15æ—¥*